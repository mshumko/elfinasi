# elfinasi

Contains classes to load Electron Losses and Fields Investigation (ELFIN; https://elfin.igpp.ucla.edu/) L2 data, make pitch angle distributions (PADs), and well plot ELFIN above auroral all-sky imagers (ASIs).

![ELFIN-B data showing an electron isotropy boundary](https://github.com/mshumko/elfinasi/blob/d5a6ded9bbab9b9aca47693a47ee8cc7d5ec9cc1/docs/20200902_1420_elfinb_example.png)

*Example ELFIN-B data showing an electron isotropy boundary, generated from the `test_pad_plot` test in `test_pad.py`. Event from [Wilkins+2023](https://doi.org/10.1029/2023JA031774).*

## Installation

```shell
$ python -m pip install git+https://github.com/mshumko/elfinasi.git
```

To locally install in editable mode run
```shell
$ cd elfinasi/
$ python -m pip install -e .
```

## ELFIN loading and analysis functions.
The `src/elfinasi/elfin.py` module contains five classes to load and analyze 
1. `elfinasi.State` --- Load the ELFIN ephemeris,
2. `elfinasi.EPD` --- load the ELFIN L1 and L2 cdf files,
3. `elfinasi.MagEphem`  --- Use IRBEM to produce magnetic ephemeris,
4. `elfinasi.EPD_PAD` --- Use the L1 and L2 EPD data and make plots including omnidirectional and BLC/DLC flux. 
5. `elfinasi.EPD_PAD_ARTEMYEV` --- Same as EPD_PAD, but for the custom files provided by Dr. Anton Artemyev.

## The 4 September 2022 event scripts.
The `src/20240904_substorm_study` folder contains scripts to reproduce figures for the Shumko+2025 paper which includes TREx, ELFIN, THEMIS, and optionally POES.

> **_NOTE:_** You must install [IRBEM](https://github.com/PRBEM/IRBEM), in addition to `elfinasi`, as we use it for the magnetic field line tracing.

The scripts `fig#.py` and `movie_s#.py` correspond to the figures and animations in the paper. Furthermore, it contains the `20220904_0425_trex_poes_conjunction.ipynb` Jupyter notebook to plot and animate the TREx-POES conjunction for Fig. S3 and Movie S3.

<video width="100%" controls>
    <source src="docs/movie_s2.mp4" type="video/mp4">
</video>

*Animated ELFIN-TREx conjunction that is generated by `src/20240904_substorm_study/movie_s2.py`*

Lastly, the `src/20240904_substorm_study/misc` folder contains notebooks and scripts that did not make it into the paper, but may be useful.
